


<!DOCTYPE html>
<html>
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# githubog: http://ogp.me/ns/fb/githubog#">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>openc_bot/README.md at master · openc/openc_bot · GitHub</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub" />
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub" />
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-144.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144.png" />
    <link rel="logo" type="image/svg" href="https://github-media-downloads.s3.amazonaws.com/github-logo.svg" />
    <meta property="og:image" content="https://github.global.ssl.fastly.net/images/modules/logos_page/Octocat.png">
    <meta name="hostname" content="github-fe122-cp1-prd.iad.github.net">
    <meta name="ruby" content="ruby 1.9.3p194-tcs-github-tcmalloc (e1c0c3f392) [x86_64-linux]">
    <link rel="assets" href="https://github.global.ssl.fastly.net/">
    <link rel="conduit-xhr" href="https://ghconduit.com:25035/">
    <link rel="xhr-socket" href="/_sockets" />
    


    <meta name="msapplication-TileImage" content="/windows-tile.png" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="selected-link" value="repo_source" data-pjax-transient />
    <meta content="collector.githubapp.com" name="octolytics-host" /><meta content="collector-cdn.github.com" name="octolytics-script-host" /><meta content="github" name="octolytics-app-id" /><meta content="31CE7304:61F1:C23007:529D667C" name="octolytics-dimension-request_id" />
    

    
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <meta content="authenticity_token" name="csrf-param" />
<meta content="afYGOWr4h5Qwg2Ld3E516DWSKAW6fPFk/vNJV0p7qTU=" name="csrf-token" />

    <link href="https://github.global.ssl.fastly.net/assets/github-4fb1bd5b1cfc52208aadd90424bff1dd908b943a.css" media="all" rel="stylesheet" type="text/css" />
    <link href="https://github.global.ssl.fastly.net/assets/github2-103e0f590e60415187fe87f0a0bcf19b2fc283b3.css" media="all" rel="stylesheet" type="text/css" />
    

    

      <script src="https://github.global.ssl.fastly.net/assets/frameworks-e9988e2b0a558181a303f55fab325a5f0bdee951.js" type="text/javascript"></script>
      <script src="https://github.global.ssl.fastly.net/assets/github-063f13ec73b5b9c393647269487e44072d2eb037.js" type="text/javascript"></script>
      
      <meta http-equiv="x-pjax-version" content="5734e3734af9aeca7d648bd82d48c0a1">

        <link data-pjax-transient rel='permalink' href='/openc/openc_bot/blob/10b24b6edbc85908ea738dbc05a1c041a7bac069/README.md'>
  <meta property="og:title" content="openc_bot"/>
  <meta property="og:type" content="githubog:gitrepository"/>
  <meta property="og:url" content="https://github.com/openc/openc_bot"/>
  <meta property="og:image" content="https://github.global.ssl.fastly.net/images/gravatars/gravatar-user-420.png"/>
  <meta property="og:site_name" content="GitHub"/>
  <meta property="og:description" content="openc_bot - Utility gem for writing bots for OpenCorporates"/>

  <meta name="description" content="openc_bot - Utility gem for writing bots for OpenCorporates" />

  <meta content="439097" name="octolytics-dimension-user_id" /><meta content="openc" name="octolytics-dimension-user_login" /><meta content="12159744" name="octolytics-dimension-repository_id" /><meta content="openc/openc_bot" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="12159744" name="octolytics-dimension-repository_network_root_id" /><meta content="openc/openc_bot" name="octolytics-dimension-repository_network_root_nwo" />
  <link href="https://github.com/openc/openc_bot/commits/master.atom" rel="alternate" title="Recent Commits to openc_bot:master" type="application/atom+xml" />

  </head>


  <body class="logged_out  env-production  vis-public page-blob">
    <div class="wrapper">
      
      
      
      


      
      <div class="header header-logged-out">
  <div class="container clearfix">

    <a class="header-logo-wordmark" href="https://github.com/">
      <span class="mega-octicon octicon-logo-github"></span>
    </a>

    <div class="header-actions">
        <a class="button primary" href="/join">Sign up</a>
      <a class="button signin" href="/login?return_to=%2Fopenc%2Fopenc_bot%2Fblob%2Fmaster%2FREADME.md">Sign in</a>
    </div>

    <div class="command-bar js-command-bar  in-repository">

      <ul class="top-nav">
          <li class="explore"><a href="/explore">Explore</a></li>
        <li class="features"><a href="/features">Features</a></li>
          <li class="enterprise"><a href="https://enterprise.github.com/">Enterprise</a></li>
          <li class="blog"><a href="/blog">Blog</a></li>
      </ul>
        <form accept-charset="UTF-8" action="/search" class="command-bar-form" id="top_search_form" method="get">

<input type="text" data-hotkey="/ s" name="q" id="js-command-bar-field" placeholder="Search or type a command" tabindex="1" autocapitalize="off"
    
    
      data-repo="openc/openc_bot"
      data-branch="master"
      data-sha="1a71eb71910d9e8e83d729445d9d6a4f6945a37b"
  >

    <input type="hidden" name="nwo" value="openc/openc_bot" />

    <div class="select-menu js-menu-container js-select-menu search-context-select-menu">
      <span class="minibutton select-menu-button js-menu-target">
        <span class="js-select-button">This repository</span>
      </span>

      <div class="select-menu-modal-holder js-menu-content js-navigation-container">
        <div class="select-menu-modal">

          <div class="select-menu-item js-navigation-item js-this-repository-navigation-item selected">
            <span class="select-menu-item-icon octicon octicon-check"></span>
            <input type="radio" class="js-search-this-repository" name="search_target" value="repository" checked="checked" />
            <div class="select-menu-item-text js-select-button-text">This repository</div>
          </div> <!-- /.select-menu-item -->

          <div class="select-menu-item js-navigation-item js-all-repositories-navigation-item">
            <span class="select-menu-item-icon octicon octicon-check"></span>
            <input type="radio" name="search_target" value="global" />
            <div class="select-menu-item-text js-select-button-text">All repositories</div>
          </div> <!-- /.select-menu-item -->

        </div>
      </div>
    </div>

  <span class="octicon help tooltipped downwards" title="Show command bar help">
    <span class="octicon octicon-question"></span>
  </span>


  <input type="hidden" name="ref" value="cmdform">

</form>
    </div>

  </div>
</div>


      


          <div class="site" itemscope itemtype="http://schema.org/WebPage">
    
    <div class="pagehead repohead instapaper_ignore readability-menu">
      <div class="container">
        

<ul class="pagehead-actions">


  <li>
    <a href="/login?return_to=%2Fopenc%2Fopenc_bot"
    class="minibutton with-count js-toggler-target star-button tooltipped upwards"
    title="You must be signed in to use this feature" rel="nofollow">
    <span class="octicon octicon-star"></span>Star
  </a>

    <a class="social-count js-social-count" href="/openc/openc_bot/stargazers">
      0
    </a>

  </li>

    <li>
      <a href="/login?return_to=%2Fopenc%2Fopenc_bot"
        class="minibutton with-count js-toggler-target fork-button tooltipped upwards"
        title="You must be signed in to fork a repository" rel="nofollow">
        <span class="octicon octicon-git-branch"></span>Fork
      </a>
      <a href="/openc/openc_bot/network" class="social-count">
        1
      </a>
    </li>
</ul>

        <h1 itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="entry-title public">
          <span class="repo-label"><span>public</span></span>
          <span class="mega-octicon octicon-repo"></span>
          <span class="author">
            <a href="/openc" class="url fn" itemprop="url" rel="author"><span itemprop="title">openc</span></a>
          </span>
          <span class="repohead-name-divider">/</span>
          <strong><a href="/openc/openc_bot" class="js-current-repository js-repo-home-link">openc_bot</a></strong>

          <span class="page-context-loader">
            <img alt="Octocat-spinner-32" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
          </span>

        </h1>
      </div><!-- /.container -->
    </div><!-- /.repohead -->

    

    <div class="container">

      <div class="repository-with-sidebar repo-container  ">

        <div class="repository-sidebar">
            

<div class="sunken-menu vertical-right repo-nav js-repo-nav js-repository-container-pjax js-octicon-loaders">
  <div class="sunken-menu-contents">
    <ul class="sunken-menu-group">
      <li class="tooltipped leftwards" title="Code">
        <a href="/openc/openc_bot" aria-label="Code" class="selected js-selected-navigation-item sunken-menu-item" data-gotokey="c" data-pjax="true" data-selected-links="repo_source repo_downloads repo_commits repo_tags repo_branches /openc/openc_bot">
          <span class="octicon octicon-code"></span> <span class="full-word">Code</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

        <li class="tooltipped leftwards" title="Issues">
          <a href="/openc/openc_bot/issues" aria-label="Issues" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-gotokey="i" data-selected-links="repo_issues /openc/openc_bot/issues">
            <span class="octicon octicon-issue-opened"></span> <span class="full-word">Issues</span>
            <span class='counter'>2</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>

      <li class="tooltipped leftwards" title="Pull Requests"><a href="/openc/openc_bot/pulls" aria-label="Pull Requests" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-gotokey="p" data-selected-links="repo_pulls /openc/openc_bot/pulls">
            <span class="octicon octicon-git-pull-request"></span> <span class="full-word">Pull Requests</span>
            <span class='counter'>1</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>


        <li class="tooltipped leftwards" title="Wiki">
          <a href="/openc/openc_bot/wiki" aria-label="Wiki" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="repo_wiki /openc/openc_bot/wiki">
            <span class="octicon octicon-book"></span> <span class="full-word">Wiki</span>
            <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>
    </ul>
    <div class="sunken-menu-separator"></div>
    <ul class="sunken-menu-group">

      <li class="tooltipped leftwards" title="Pulse">
        <a href="/openc/openc_bot/pulse" aria-label="Pulse" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="pulse /openc/openc_bot/pulse">
          <span class="octicon octicon-pulse"></span> <span class="full-word">Pulse</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

      <li class="tooltipped leftwards" title="Graphs">
        <a href="/openc/openc_bot/graphs" aria-label="Graphs" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="repo_graphs repo_contributors /openc/openc_bot/graphs">
          <span class="octicon octicon-graph"></span> <span class="full-word">Graphs</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

      <li class="tooltipped leftwards" title="Network">
        <a href="/openc/openc_bot/network" aria-label="Network" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-selected-links="repo_network /openc/openc_bot/network">
          <span class="octicon octicon-git-branch"></span> <span class="full-word">Network</span>
          <img alt="Octocat-spinner-32" class="mini-loader" height="16" src="https://github.global.ssl.fastly.net/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>
    </ul>


  </div>
</div>

            <div class="only-with-full-nav">
              

  

<div class="clone-url open"
  data-protocol-type="http"
  data-url="/users/set_protocol?protocol_selector=http&amp;protocol_type=clone">
  <h3><strong>HTTPS</strong> clone URL</h3>
  <div class="clone-url-box">
    <input type="text" class="clone js-url-field"
           value="https://github.com/openc/openc_bot.git" readonly="readonly">

    <span class="js-zeroclipboard url-box-clippy minibutton zeroclipboard-button" data-clipboard-text="https://github.com/openc/openc_bot.git" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
  </div>
</div>

  

<div class="clone-url "
  data-protocol-type="subversion"
  data-url="/users/set_protocol?protocol_selector=subversion&amp;protocol_type=clone">
  <h3><strong>Subversion</strong> checkout URL</h3>
  <div class="clone-url-box">
    <input type="text" class="clone js-url-field"
           value="https://github.com/openc/openc_bot" readonly="readonly">

    <span class="js-zeroclipboard url-box-clippy minibutton zeroclipboard-button" data-clipboard-text="https://github.com/openc/openc_bot" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
  </div>
</div>


<p class="clone-options">You can clone with
      <a href="#" class="js-clone-selector" data-protocol="http">HTTPS</a>,
      or <a href="#" class="js-clone-selector" data-protocol="subversion">Subversion</a>.
  <span class="octicon help tooltipped upwards" title="Get help on which URL is right for you.">
    <a href="https://help.github.com/articles/which-remote-url-should-i-use">
    <span class="octicon octicon-question"></span>
    </a>
  </span>
</p>



              <a href="/openc/openc_bot/archive/master.zip"
                 class="minibutton sidebar-button"
                 title="Download this repository as a zip file"
                 rel="nofollow">
                <span class="octicon octicon-cloud-download"></span>
                Download ZIP
              </a>
            </div>
        </div><!-- /.repository-sidebar -->

        <div id="js-repo-pjax-container" class="repository-content context-loader-container" data-pjax-container>
          


<!-- blob contrib key: blob_contributors:v21:092d0f361d64b8cc9f5800843fb9c06b -->

<p title="This is a placeholder element" class="js-history-link-replace hidden"></p>

<a href="/openc/openc_bot/find/master" data-pjax data-hotkey="t" class="js-show-file-finder" style="display:none">Show File Finder</a>

<div class="file-navigation">
  

<div class="select-menu js-menu-container js-select-menu" >
  <span class="minibutton select-menu-button js-menu-target" data-hotkey="w"
    data-master-branch="master"
    data-ref="master"
    role="button" aria-label="Switch branches or tags" tabindex="0">
    <span class="octicon octicon-git-branch"></span>
    <i>branch:</i>
    <span class="js-select-button">master</span>
  </span>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax>

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <span class="select-menu-title">Switch branches/tags</span>
        <span class="octicon octicon-remove-close js-menu-close"></span>
      </div> <!-- /.select-menu-header -->

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" class="js-select-menu-tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" class="js-select-menu-tab">Tags</a>
            </li>
          </ul>
        </div><!-- /.select-menu-tabs -->
      </div><!-- /.select-menu-filters -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <div class="select-menu-item js-navigation-item ">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/openc/openc_bot/blob/documentation_update/README.md"
                 data-name="documentation_update"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target"
                 title="documentation_update">documentation_update</a>
            </div> <!-- /.select-menu-item -->
            <div class="select-menu-item js-navigation-item selected">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/openc/openc_bot/blob/master/README.md"
                 data-name="master"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target"
                 title="master">master</a>
            </div> <!-- /.select-menu-item -->
            <div class="select-menu-item js-navigation-item ">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/openc/openc_bot/blob/openc_bot-refactor/README.md"
                 data-name="openc_bot-refactor"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target"
                 title="openc_bot-refactor">openc_bot-refactor</a>
            </div> <!-- /.select-menu-item -->
            <div class="select-menu-item js-navigation-item ">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/openc/openc_bot/blob/schema-update/README.md"
                 data-name="schema-update"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target"
                 title="schema-update">schema-update</a>
            </div> <!-- /.select-menu-item -->
            <div class="select-menu-item js-navigation-item ">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/openc/openc_bot/blob/schema-update-2/README.md"
                 data-name="schema-update-2"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text js-select-button-text css-truncate-target"
                 title="schema-update-2">schema-update-2</a>
            </div> <!-- /.select-menu-item -->
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div> <!-- /.select-menu-list -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div> <!-- /.select-menu-list -->

    </div> <!-- /.select-menu-modal -->
  </div> <!-- /.select-menu-modal-holder -->
</div> <!-- /.select-menu -->

  <div class="breadcrumb">
    <span class='repo-root js-repo-root'><span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="/openc/openc_bot" data-branch="master" data-direction="back" data-pjax="true" itemscope="url"><span itemprop="title">openc_bot</span></a></span></span><span class="separator"> / </span><strong class="final-path">README.md</strong> <span class="js-zeroclipboard minibutton zeroclipboard-button" data-clipboard-text="README.md" data-copied-hint="copied!" title="copy to clipboard"><span class="octicon octicon-clippy"></span></span>
  </div>
</div>



  <div class="commit file-history-tease">
    <img class="main-avatar" height="24" src="https://0.gravatar.com/avatar/fd2ee04ed34353f9679324c44f50e073?d=https%3A%2F%2Fidenticons.github.com%2Fb19a3a9062259ba2d0562f3dc268b29b.png&amp;r=x&amp;s=140" width="24" />
    <span class="author"><a href="/sebbacon" rel="author">sebbacon</a></span>
    <time class="js-relative-date" datetime="2013-11-28T08:12:00-08:00" title="2013-11-28 08:12:00">November 28, 2013</time>
    <div class="commit-title">
        <a href="/openc/openc_bot/commit/a5c51a88890f813f6034b9d436250a989fad8828" class="message" data-pjax="true" title="Expect a scrape run to be interrupted">Expect a scrape run to be interrupted</a>
    </div>

    <div class="participation">
      <p class="quickstat"><a href="#blob_contributors_box" rel="facebox"><strong>4</strong> contributors</a></p>
          <a class="avatar tooltipped downwards" title="xavriley" href="/openc/openc_bot/commits/master/README.md?author=xavriley"><img height="20" src="https://2.gravatar.com/avatar/b2af84945053d954748431aa829fd324?d=https%3A%2F%2Fidenticons.github.com%2Fc3be7f0b931a3cf753e9b41b9ffff2b5.png&amp;r=x&amp;s=140" width="20" /></a>
    <a class="avatar tooltipped downwards" title="inglesp" href="/openc/openc_bot/commits/master/README.md?author=inglesp"><img height="20" src="https://0.gravatar.com/avatar/510f52d9d1b77f5088505ed49608f5d7?d=https%3A%2F%2Fidenticons.github.com%2F9767eb6137bb1e88380c96bbf5ad99bb.png&amp;r=x&amp;s=140" width="20" /></a>
    <a class="avatar tooltipped downwards" title="sebbacon" href="/openc/openc_bot/commits/master/README.md?author=sebbacon"><img height="20" src="https://0.gravatar.com/avatar/fd2ee04ed34353f9679324c44f50e073?d=https%3A%2F%2Fidenticons.github.com%2Fb19a3a9062259ba2d0562f3dc268b29b.png&amp;r=x&amp;s=140" width="20" /></a>
    <a class="avatar tooltipped downwards" title="CountCulture" href="/openc/openc_bot/commits/master/README.md?author=CountCulture"><img height="20" src="https://1.gravatar.com/avatar/179bdb9ccec4a786e048a21586942f1c?d=https%3A%2F%2Fidenticons.github.com%2Fab130df6b0564471063c3387c2a07e4a.png&amp;r=x&amp;s=140" width="20" /></a>


    </div>
    <div id="blob_contributors_box" style="display:none">
      <h2 class="facebox-header">Users who have contributed to this file</h2>
      <ul class="facebox-user-list">
          <li class="facebox-user-list-item">
            <img height="24" src="https://2.gravatar.com/avatar/b2af84945053d954748431aa829fd324?d=https%3A%2F%2Fidenticons.github.com%2Fc3be7f0b931a3cf753e9b41b9ffff2b5.png&amp;r=x&amp;s=140" width="24" />
            <a href="/xavriley">xavriley</a>
          </li>
          <li class="facebox-user-list-item">
            <img height="24" src="https://0.gravatar.com/avatar/510f52d9d1b77f5088505ed49608f5d7?d=https%3A%2F%2Fidenticons.github.com%2F9767eb6137bb1e88380c96bbf5ad99bb.png&amp;r=x&amp;s=140" width="24" />
            <a href="/inglesp">inglesp</a>
          </li>
          <li class="facebox-user-list-item">
            <img height="24" src="https://0.gravatar.com/avatar/fd2ee04ed34353f9679324c44f50e073?d=https%3A%2F%2Fidenticons.github.com%2Fb19a3a9062259ba2d0562f3dc268b29b.png&amp;r=x&amp;s=140" width="24" />
            <a href="/sebbacon">sebbacon</a>
          </li>
          <li class="facebox-user-list-item">
            <img height="24" src="https://1.gravatar.com/avatar/179bdb9ccec4a786e048a21586942f1c?d=https%3A%2F%2Fidenticons.github.com%2Fab130df6b0564471063c3387c2a07e4a.png&amp;r=x&amp;s=140" width="24" />
            <a href="/CountCulture">CountCulture</a>
          </li>
      </ul>
    </div>
  </div>

<div id="files" class="bubble">
  <div class="file">
    <div class="meta">
      <div class="info">
        <span class="icon"><b class="octicon octicon-file-text"></b></span>
        <span class="mode" title="File Mode">file</span>
          <span>453 lines (331 sloc)</span>
        <span>16.866 kb</span>
      </div>
      <div class="actions">
        <div class="button-group">
              <a class="minibutton disabled tooltipped leftwards" href="#"
                 title="You must be signed in to make or propose changes">Edit</a>
          <a href="/openc/openc_bot/raw/master/README.md" class="button minibutton " id="raw-url">Raw</a>
            <a href="/openc/openc_bot/blame/master/README.md" class="button minibutton ">Blame</a>
          <a href="/openc/openc_bot/commits/master/README.md" class="button minibutton " rel="nofollow">History</a>
        </div><!-- /.button-group -->
          <a class="minibutton danger disabled empty-icon tooltipped leftwards" href="#"
             title="You must be signed in and on a branch to make or propose changes">
          Delete
        </a>
      </div><!-- /.actions -->

    </div>
      
  <div id="readme" class="blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="opencbot" class="anchor" href="#opencbot"><span class="octicon octicon-link"></span></a>OpencBot</h1>

<h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>This is a gem to allow bots to be written to fetch and format data that can be easily imported into 
OpenCorporates, the largest openly licensed database of companies in the world. It also aims to be a curated 
set of tools to allow data to be retrieved, formatted and imported on a regular basis.</p>

<p>By including OpencBot you have access to a number of methods for setting up and writing to/reading
from a local SQLite database in which the data can be stored. It is expected to expose two class or module
methods: #update_data and #export_data. If the exported data is in the correct format it will be able to
be seamlessly able to be imported into OpenCorporates.</p>

<h2>
<a name="how-to-installcreate-a-bot" class="anchor" href="#how-to-installcreate-a-bot"><span class="octicon octicon-link"></span></a>How to install/create a bot</h2>

<div class="highlight highlight-bash"><pre>mkdir your_bot_name
<span class="nb">cd </span>your_bot_name
curl -s https://raw.github.com/openc/openc_bot/master/create_bot.sh | bash
</pre></div>

<h2>
<a name="required-methods" class="anchor" href="#required-methods"><span class="octicon octicon-link"></span></a>Required methods</h2>

<p>A bot module should look like this:</p>

<div class="highlight highlight-ruby"><pre><span class="no">Module</span> <span class="no">MyBot</span>
  <span class="kp">extend</span> <span class="no">OpencBot</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="k">def</span> <span class="nf">update_data</span>
    <span class="c1"># fetch or scrape data and store (possibly in local SQLite database)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">export_data</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{})</span>
    <span class="c1"># return data (possibly from the SQLite database)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>If you follow the conventions and use these methods (and you must do in order for this to validate)
there are several tasks available to you to run and test the data</p>

<pre><code>bundle exec openc_bot rake bot:create # creates the bot in the first place
bundle exec openc_bot rake bot:run    # runs the #update_data method
bundle exec openc_bot rake bot:export # runs the #export_data method and outputs data to stdout as JSON
bundle exec openc_bot rake bot:test   # validates that the exported data conforms to the basic data structure expected
</code></pre>

<h2>
<a name="directory-structure" class="anchor" href="#directory-structure"><span class="octicon octicon-link"></span></a>Directory structure</h2>

<h4>
<a name="nb-the-data-db-and-tmp-directories-should-not-be-committed-to-git" class="anchor" href="#nb-the-data-db-and-tmp-directories-should-not-be-committed-to-git"><span class="octicon octicon-link"></span></a>NB the <code>data</code>, <code>db</code> and <code>tmp</code> directories should not be committed to git</h4>

<pre><code>root
  |_config.yml  # A YAML file with configuration for the bot
  |_data/       # Put persistent data in here
  |_db/         # This is where the sqlite database will be stored
  |_lib/        # For the code itself
  |_spec/       # For the specs
  |_tmp/        # Temporary store
</code></pre>

<p>Data in data/ and db/ will be persisted through deployments, but tmp/ will not be persisted.</p>

<h2>
<a name="how-to-export-the-data" class="anchor" href="#how-to-export-the-data"><span class="octicon octicon-link"></span></a>How to export the data</h2>

<h3>
<a name="description-of-output-format" class="anchor" href="#description-of-output-format"><span class="octicon octicon-link"></span></a>Description of output format</h3>

<h4>
<a name="the-following-info-is-specific-to-finance-licenses" class="anchor" href="#the-following-info-is-specific-to-finance-licenses"><span class="octicon octicon-link"></span></a>The following info is specific to Finance Licenses</h4>

<h4>
<a name="this-is-still-under-discussion-and-is-subject-to-change-please-ask-if-unsure" class="anchor" href="#this-is-still-under-discussion-and-is-subject-to-change-please-ask-if-unsure"><span class="octicon octicon-link"></span></a>This is still under discussion and is subject to change. Please ask if unsure.</h4>

<p>We expect licence data as a hash with the following keys:</p>

<pre><code>:sample_date
    required (if end_date is not provided)
:start_date
    optional
:start_date_type
    required if :start_date is present
    one of "at", "before", or "after"
:end_date
    optional (if sample_date is provided)
:end_date_type
    required if :end_date is present
    one of "at", "before", or "after"
:company
    required
    a hash with the following keys:
        :name
            required
            a string of the name of the company
        :jurisdiction
            required
            a string of the jurisdiction
                eg "us_ca"
:source_url
    required
    a string of the URL of the data
:data
    required
    an array with a single hash, with the following keys:
        :data_type
            required
            must be :licence
        :properties
            required
            a hash with the following keys:
                :licence_number
                    optional
                :jurisdiction_tags
                    required
                    an array of strings that describe the licence or the licenced company, using the vocabulary of the data source
                    examples might be:
                        foreign bank branch
                        co-operative credit
                        motor vehicle finance
                        trust company
                :oc_tags
                    not required yet
                    an array of strings that describe the licence or the licenced company, taken from a vocabulary list provided by OpenCorporates
</code></pre>

<h4>
<a name="about-the-date-fields" class="anchor" href="#about-the-date-fields"><span class="octicon octicon-link"></span></a>About the date fields</h4>

<h3>
<a name="what-to-do-when-data-no-longer-exists" class="anchor" href="#what-to-do-when-data-no-longer-exists"><span class="octicon octicon-link"></span></a>What to do when data no longer exists</h3>

<p>It is difficult to  accommodate every type of variation in how data can be classified as 'fresh' or 'out of date' and 
so on. This means that we need help from bot authors in identifying when data is no longer valid.</p>

<p>This will usually mean that you will have to timestamp records for each run, making sure to update the timestamp of 
records that are still available but haven't changed. After each run you may find that some records have "dropped off" 
the source and are no longer available/valid. <em>For these records</em> the thing to do when something stops being true 
is to post it with an identical <code>:properties</code> as above but with an <code>:end_date</code> of <code>today</code> and <code>:end_date_type</code> of <code>"before"</code>, 
<em>INSTEAD</em> of a <code>sample date</code>.</p>

<p><em>For all the current records that are otherwise unchanged</em> you can still submit them with a new <code>sample_date</code> so 
that we know they are still current. After 15 months we assume this is no longer the case, so your code should consider resubmitting unchanged records at least once every 15 months.</p>

<h2>
<a name="general-tips-on-writing-a-bot" class="anchor" href="#general-tips-on-writing-a-bot"><span class="octicon octicon-link"></span></a>General tips on writing a bot</h2>

<p>All data sources are different, so the following are just pointers as opposed to rules.</p>

<h3>
<a name="break-it-into-stages" class="anchor" href="#break-it-into-stages"><span class="octicon octicon-link"></span></a>Break it into stages</h3>

<p>Think about breaking the scraping process down into three stages. This is sometimes referred to 
as "Extract, Transform, Load"</p>

<p>"Extract" would mean saving the pages/data to the data folder. "Transform" means loading these files from the 
data folder and parsing them into the right format (probably a hash). The final step, "Load", simply means saving them 
the the database using the <code>save_data</code> method.</p>

<h4>
<a name="example-extract" class="anchor" href="#example-extract"><span class="octicon octicon-link"></span></a>Example: Extract</h4>

<div class="highlight highlight-ruby"><pre><span class="k">module</span> <span class="nn">MyBot</span>
  <span class="kp">extend</span> <span class="nb">self</span>
  <span class="no">SOURCE_FILE_URL</span> <span class="o">=</span> <span class="s1">'http://www.dfi.utah.gov/Download/INSTADDR.TXT'</span>

  <span class="c1"># ... other methods</span>

  <span class="k">def</span> <span class="nf">extract</span>
    <span class="n">src</span> <span class="o">=</span> <span class="no">MyBot</span><span class="o">.</span><span class="n">scrape</span><span class="p">(</span><span class="no">SOURCE_FILE_URL</span><span class="p">)</span>
    <span class="n">outfile</span> <span class="o">=</span>  <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">"../data/utah_institutions_file.txt"</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">))</span>

    <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span> <span class="n">src</span><span class="p">}</span>
  <span class="k">end</span>

  <span class="c1"># ... other methods</span>
<span class="k">end</span>
</pre></div>

<p>Saving to disk first provides some benefits in terms of being able to re-run a scraper on failure. It also makes it 
easier to trace if there have been problems with the data.</p>

<h4>
<a name="example-transform" class="anchor" href="#example-transform"><span class="octicon octicon-link"></span></a>Example: Transform</h4>

<div class="highlight highlight-ruby"><pre><span class="k">module</span> <span class="nn">MyBot</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="c1"># ... </span>

  <span class="k">def</span> <span class="nf">transform</span>
    <span class="n">src_path</span> <span class="o">=</span>  <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">"../data/utah_institutions_file.txt"</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">))</span>
    <span class="n">src</span> <span class="o">=</span> <span class="no">IO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>

    <span class="no">CSV</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
      <span class="n">new_row</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="ss">:retrieved_at</span> <span class="o">=&gt;</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
      <span class="n">new_row</span><span class="o">[</span><span class="ss">:company_name</span><span class="o">]</span> <span class="o">=</span> <span class="n">row</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/[[:space:]]+/</span><span class="p">,</span> <span class="s1">' '</span><span class="p">)</span> <span class="c1"># for example</span>
      <span class="n">new_row</span> <span class="c1"># this is now a data hash ready for import</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># ...</span>
<span class="k">end</span>
</pre></div>

<p>This is a very simple example. You will probably need to break out the process into more methods, but 
consider keeping them "wrapped" in a transform method so that you and other scraper authors can see what 
is going on in future.</p>

<h4>
<a name="example-load" class="anchor" href="#example-load"><span class="octicon octicon-link"></span></a>Example: Load</h4>

<div class="highlight highlight-ruby"><pre><span class="k">module</span> <span class="nn">MyBot</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="c1"># ... </span>

  <span class="k">def</span> <span class="nf">load</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">transform</span> <span class="c1"># from our previous example</span>
    <span class="n">save_data</span><span class="p">(</span><span class="o">[</span><span class="ss">:uniq_id_field</span><span class="o">]</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span>
</pre></div>

<p>This is fairly straightforward using one of the included helper methods (see <a href="#helper-methods">"Helper methods"</a>).</p>

<p><em>Why sqlite?</em> It's important to be able to view and query any data you gather in order to check it's 
accuracy and quality. We use sqlite as an interim storage method because it has very few external 
dependencies and works well in this single user environment. See the <a href="#working-with-sqlite">"Working with sqlite"</a> section for more details 
on how to query/check data with sqlite See the tips on scraping for more details on how to query/check data with sqlite.</p>

<h3>
<a name="write-some-specs" class="anchor" href="#write-some-specs"><span class="octicon octicon-link"></span></a>Write some specs</h3>

<p><em>Specs are required</em> <img class="emoji" title=":smiley_cat:" alt=":smiley_cat:" src="https://github.global.ssl.fastly.net/images/icons/emoji/smiley_cat.png" height="20" width="20" align="absmiddle">. If nothing else, specs help to explain what you were trying to do with a particular 
method. We encourage all Bot authors to take the time to write specs, as it pays off in the long run.</p>

<p>Given scraping involves retrieving resources you should be careful 
when writing specs that you <em>don't request files from the web every time they run</em>, otherwise you might find yourself getting blocked!
You can achieve this by stubbing out the <code>scrape</code> method and returning content from the <code>spec/dummy_responses</code> folder 
(see <code>spec_helper.rb</code> for details).</p>

<h4>
<a name="bad-spec" class="anchor" href="#bad-spec"><span class="octicon octicon-link"></span></a>BAD spec</h4>

<div class="highlight highlight-ruby"><pre><span class="n">describe</span> <span class="no">MyBot</span> <span class="k">do</span>

  <span class="n">it</span> <span class="s2">"should parse a HTML file"</span> <span class="k">do</span>
    <span class="n">response</span> <span class="o">=</span> <span class="no">MyModule</span><span class="o">.</span><span class="n">scrape</span><span class="p">(</span><span class="s2">"http://my-interesting-data-source.com"</span><span class="p">)</span>
    <span class="no">MyBot</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">should_not</span> <span class="n">be_empty</span>
  <span class="k">end</span>

  <span class="c1"># NO - this will hit the network every time you run the test</span>
  <span class="c1"># not only is this slow, but you're putting unnecessary load</span>
  <span class="c1"># on the data source</span>

<span class="k">end</span>
</pre></div>

<h4>
<a name="good-spec" class="anchor" href="#good-spec"><span class="octicon octicon-link"></span></a>GOOD spec</h4>

<div class="highlight highlight-ruby"><pre><span class="n">describe</span> <span class="no">MyBot</span> <span class="k">do</span>

  <span class="n">before</span> <span class="ss">:each</span> <span class="k">do</span>
    <span class="no">MyBot</span><span class="o">.</span><span class="n">stub</span><span class="p">(</span><span class="ss">:scrape</span><span class="p">)</span><span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="n">dummy_reponse</span><span class="p">(</span><span class="s1">'path/to/saved/html/response/in/spec/dummy_responses/sample.html'</span><span class="p">))</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s2">"should parse a HTML file"</span> <span class="k">do</span>
    <span class="n">response</span> <span class="o">=</span> <span class="no">MyModule</span><span class="o">.</span><span class="n">scrape</span><span class="p">(</span><span class="s2">"http://my-interesting-data-source.com"</span><span class="p">)</span>
    <span class="no">MyBot</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">should_not</span> <span class="n">be_empty</span>
  <span class="k">end</span>

  <span class="c1"># YES - this only uses a file on your local disk</span>
  <span class="c1"># This makes for a very fast test - the only downside is</span>
  <span class="c1"># that you have to keep your sample responses up to date</span>
  <span class="c1"># if they change (html layout for example) on the data source.</span>
  <span class="c1"># `stub` will change the method that you pass in, making sure that</span>
  <span class="c1"># it's original doesn't get called, but also checking that the new </span>
  <span class="c1"># dummy method will.</span>
  <span class="c1"># `and_return` is a way of simulating what that method would have responded with</span>
  <span class="c1"># `dummy_response` is defined in the sample spec_helper.rb file</span>

<span class="k">end</span>
</pre></div>

<p>For general advice on using RSpec, there is a good slide deck here: <a href="http://kerryb.github.io/iprug-rspec-presentation/">http://kerryb.github.io/iprug-rspec-presentation/</a>
For general RSpec style guidelines, <a href="http://betterspecs.org/">http://betterspecs.org/</a> is worth a read.</p>

<h3>
<a name="expect-it-to-be-interrupted" class="anchor" href="#expect-it-to-be-interrupted"><span class="octicon octicon-link"></span></a>Expect it to be interrupted</h3>

<p>It's not unusual for scrapes to take several days. Power cuts and accidental keypresses do happen. Your script should contain code that allows it to resume where it left off if interrupted; for example, storing the latest value of a counter, or logging some identifier for each record which allows it to be re-got. The <code>save_var</code> and <code>get_var</code> methods documented below are useful for this; or you can log identifiers to a sqlite table.</p>

<h3>
<a name="check-with-your-own-eyes" class="anchor" href="#check-with-your-own-eyes"><span class="octicon octicon-link"></span></a>Check with your own eyes</h3>

<p>It's always a good idea to look at the data you've collected to see if you're happy with it. There are several good 
sqlite clients available, or alternatively you can use the command line - <code>sqlite3 path/to/my/database.db</code>
Check to see for any obvious issues before submitting your bot.</p>

<p>See the <a href="#working-with-sqlite">Working with sqlite</a> section for examples on how you can analyse and agregate your data 
to check for issues.</p>

<h3>
<a name="documentation-documentation-documentation" class="anchor" href="#documentation-documentation-documentation"><span class="octicon octicon-link"></span></a>Documentation, documentation, documentation</h3>

<p>You often learn a lot about a domain whilst working on a scraper and it's important that this is saved with the bot. 
Follow the instructions in the generated <code>README</code> file and you should be off to a good start. It's important for others 
to be able to review and understand what you've written in case they need to work on it in future.</p>

<h2>
<a name="other-things-to-consider" class="anchor" href="#other-things-to-consider"><span class="octicon octicon-link"></span></a>Other things to consider</h2>

<h3>
<a name="what-category-is-your-scraper" class="anchor" href="#what-category-is-your-scraper"><span class="octicon octicon-link"></span></a>What category is your scraper?</h3>

<p><strong>Simple</strong> - retrieving a static file in a standard format (e.g. CSV)</p>

<p><strong>Incremental</strong> - scraping a site by incrementing some id parameter eg. a query string param <code>?id=47</code></p>

<p><strong>Iterative</strong> - working over a range of possible inputs eg. searching for all the letters from <code>a..z</code></p>

<p>Each of these have their separate challenges and some data sources require a combination of all three. With the 
incremental and iterative steps, it's a good idea to keep track of where you are up to in case you need to stop/restart 
the bot (see the <code>get_var</code> and <code>save_var</code> example in <a href="#helper-methods">Helper methods</a>).</p>

<h2>
<a name="working-with-sqlite" class="anchor" href="#working-with-sqlite"><span class="octicon octicon-link"></span></a>Working with sqlite</h2>

<p>This bot includes a copy of the sqlite3 <em>gem</em>, but you might need to install the sqlite3 program using your 
package manage (<code>brew</code>, <code>apt-get</code>, <code>yum</code> etc.)</p>

<p>In the root folder of your bot, you should be able to run </p>

<div class="highlight highlight-bash"><pre>sqlite3 db/mybotname.db
</pre></div>

<p>where <code>mybotname</code> is the name of your bot. This will open up an sql prompt. A few useful commands:</p>

<h4>
<a name="help" class="anchor" href="#help"><span class="octicon octicon-link"></span></a>.help</h4>

<h4>
<a name="tables" class="anchor" href="#tables"><span class="octicon octicon-link"></span></a>.tables</h4>

<p>These will let you know what to do in most cases. Commands beginning with a dot (<code>.</code>) have a special meaning 
in the sqlite prompt.</p>

<h4>
<a name="mode-line" class="anchor" href="#mode-line"><span class="octicon octicon-link"></span></a>.mode line</h4>

<p>Nice format for reviewing records at the shell</p>

<div class="highlight highlight-sql"><pre><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">us_nj_banks</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">RANDOM</span><span class="p">()</span> <span class="k">LIMIT</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>

<pre><code>        licensee_name = RICHARDSON IMPORTS INC
              ref_num = 8901006
business_name_address = RICHARDSON IMPORTS INC1230 ROUTE 73MOUNT LAUREL, NJ 08054
         license_type = MOTOR VEHICLE INSTALLMENT SELLER (CORPORATION)
               status = ACTIVELY LICENSED

        licensee_name = ISAAC,RHONDA
              ref_num = 0805480
business_name_address = EMPIRE TODAY LLC1200 TAYLORS LANESUITE 2BCINNAMINSON, NJ 08077
         license_type = HOME REPAIR SALESMAN
               status = ACTIVELY LICENSED
</code></pre>

<h4>
<a name="output-resulthtml" class="anchor" href="#output-resulthtml"><span class="octicon octicon-link"></span></a>.output result.html</h4>

<h4>
<a name="mode-html" class="anchor" href="#mode-html"><span class="octicon octicon-link"></span></a>.mode html</h4>

<p>Potentially useful way of reviewing larger numbers of records without a dedicated sqlite program. You have to 
add in the opening and closing table tags yourself though.</p>

<div class="highlight highlight-sql"><pre><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">us_nj_banks</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">RANDOM</span><span class="p">()</span> <span class="k">LIMIT</span> <span class="mi">100</span><span class="p">;</span>

<span class="c1">-- This would output 100x &lt;tr&gt; tags into a file called result.html in the project root</span>
</pre></div>

<h4>
<a name="guis-and-other-clients" class="anchor" href="#guis-and-other-clients"><span class="octicon octicon-link"></span></a>GUIs and other clients</h4>

<p>There are lots of useful GUI clients for Sqlite3. We've used the following with some success:</p>

<ul>
<li><a href="https://addons.mozilla.org/en-US/firefox/addon/sqlite-manager/">Navicat Lite (Firefox addon)</a></li>
<li><a href="http://www.navicat.com/products/navicat-essentials">Navicat Essentials (Desktop app)</a></li>
</ul><h2>
<a name="helper-methods" class="anchor" href="#helper-methods"><span class="octicon octicon-link"></span></a>Helper methods</h2>

<p>By extending OpencBot, you'll have access to the following methods which may be helpful in obtaining, 
saving and transforming data. More detailed usage is found in the generated code and README for new 
bots.</p>

<h3>
<a name="relating-to-sqlite" class="anchor" href="#relating-to-sqlite"><span class="octicon octicon-link"></span></a>Relating to sqlite</h3>

<p><strong>save_data ( uniq_keys, values_array, table_name='ocdata' )</strong> - The primary method of saving to the sqlite db.</p>

<div class="highlight highlight-ruby"><pre><span class="n">data</span> <span class="o">=</span> <span class="o">[</span>
  <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"Acme Corporation Ltd."</span><span class="p">,</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">"Investment Bank"</span><span class="p">},</span>
  <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">"Acme Holdings Ltd."</span><span class="p">,</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">"Bank Holding Company"</span><span class="p">}</span>
<span class="o">]</span>
<span class="no">MyBot</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">'ocdata'</span><span class="p">)</span>
</pre></div>

<p>This method saves data in an sqlite database named after the name of this class or module.
If no table name is given, <code>ocdata</code> will be used. The table will be created if it doesn't already exist.
The first parameter are names of unique keys, and the data element should be an array of hashes, with keys becoming the field names. 
If the table has not been created or field names are given that are not in the table, they will be created
The save_data method currently saves all values as strings.</p>

<p><strong>insert_or_update ( uniq_keys, values_array, table_name='ocdata' )</strong> - Update/insert data based on existing key sqlite db.</p>

<p>Similar to <code>save_data</code> but attempts to update the row based on the unique_key</p>

<p><strong>save_var ( name, value )</strong> - save a value to the database</p>

<p><strong>get_var ( name, default=nil )</strong> - retrive a value, with a fallback if it doesn't exist</p>

<div class="highlight highlight-ruby"><pre><span class="n">current_id</span> <span class="o">=</span> <span class="no">MyBot</span><span class="o">.</span><span class="n">get_var</span><span class="p">(</span><span class="s1">'current_id'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># get the last good id, otherwise return 1</span>
<span class="n">long_scraping_process</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">page</span><span class="o">|</span>
  <span class="n">save_to_disk</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
  <span class="no">MyBot</span><span class="o">.</span><span class="n">save_var</span><span class="p">(</span><span class="n">current_id</span><span class="p">)</span>
  <span class="n">current_id</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">end</span>
</pre></div>

<p>Allows bot authors to store small bits of information between runs. Unfortunately long running bots tend
to get stopped unexpectedly in development (power cuts, connectivity failures etc.) so these methods are 
useful in picking up where you left off.</p>

<p><strong>select ( sqlquery )</strong> - Convenience method for selecting records for the sqlite db</p>

<div class="highlight highlight-ruby"><pre><span class="no">MyBot</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">'* from ocdata'</span><span class="p">)</span> <span class="c1"># return everything</span>
</pre></div>

<p><strong>save_run_report ( reporthash )</strong> - To be called at the end of each run</p>

<div class="highlight highlight-ruby"><pre><span class="no">MyBot</span><span class="o">.</span><span class="n">update_data</span>
  <span class="n">super_complicated_scrape_task</span>
  <span class="n">save_run_report</span><span class="p">(</span><span class="ss">:status</span> <span class="o">=&gt;</span> <span class="s1">'success'</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>

<p>Used by Open Corporates to monitor the status of the bot. 
Please include relevant information such as failures and error messages in the report hash.
<code>Time.now</code> is added to the output automatically.</p>

<h3>
<a name="other" class="anchor" href="#other"><span class="octicon octicon-link"></span></a>Other</h3>

<p><strong>scrape ( url, params=nil, agent=nil )</strong> - fetches content from a webserver</p>

<div class="highlight highlight-ruby"><pre><span class="no">MyBot</span><span class="o">.</span><span class="n">scrape</span><span class="p">(</span><span class="s2">"https://google.com"</span><span class="p">)</span> <span class="c1"># returns a string of the page source</span>
</pre></div>

<p>Retrieves a resource from the web and returns a string. Uses the HTTPClient gem internally which 
handles SSL and gzipped content.</p>

<h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol></article>
  </div>

  </div>
</div>

<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" class="js-jump-to-line" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
  <form accept-charset="UTF-8" class="js-jump-to-line-form">
    <input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" autofocus>
    <button type="submit" class="button">Go</button>
  </form>
</div>

        </div>

      </div><!-- /.repo-container -->
      <div class="modal-backdrop"></div>
    </div><!-- /.container -->
  </div><!-- /.site -->


    </div><!-- /.wrapper -->

      <div class="container">
  <div class="site-footer">
    <ul class="site-footer-links right">
      <li><a href="https://status.github.com/">Status</a></li>
      <li><a href="http://developer.github.com">API</a></li>
      <li><a href="http://training.github.com">Training</a></li>
      <li><a href="http://shop.github.com">Shop</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/about">About</a></li>

    </ul>

    <a href="/">
      <span class="mega-octicon octicon-mark-github"></span>
    </a>

    <ul class="site-footer-links">
      <li>&copy; 2013 <span title="0.02278s from github-fe122-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="/site/terms">Terms</a></li>
        <li><a href="/site/privacy">Privacy</a></li>
        <li><a href="/security">Security</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>
  </div><!-- /.site-footer -->
</div><!-- /.container -->


    <div class="fullscreen-overlay js-fullscreen-overlay" id="fullscreen_overlay">
  <div class="fullscreen-container js-fullscreen-container">
    <div class="textarea-wrap">
      <textarea name="fullscreen-contents" id="fullscreen-contents" class="js-fullscreen-contents" placeholder="" data-suggester="fullscreen_suggester"></textarea>
          <div class="suggester-container">
              <div class="suggester fullscreen-suggester js-navigation-container" id="fullscreen_suggester"
                 data-url="/openc/openc_bot/suggestions/commit">
              </div>
          </div>
    </div>
  </div>
  <div class="fullscreen-sidebar">
    <a href="#" class="exit-fullscreen js-exit-fullscreen tooltipped leftwards" title="Exit Zen Mode">
      <span class="mega-octicon octicon-screen-normal"></span>
    </a>
    <a href="#" class="theme-switcher js-theme-switcher tooltipped leftwards"
      title="Switch themes">
      <span class="octicon octicon-color-mode"></span>
    </a>
  </div>
</div>



    <div id="ajax-error-message" class="flash flash-error">
      <span class="octicon octicon-alert"></span>
      <a href="#" class="octicon octicon-remove-close close ajax-error-dismiss"></a>
      Something went wrong with that request. Please try again.
    </div>

  </body>
</html>

